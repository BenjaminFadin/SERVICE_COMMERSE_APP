{% load i18n_fields %}

<div class="booking-header mb-4">
  <h5 class="fw-bold mb-1">{% i18n service "name" request.LANGUAGE_CODE %}</h5>
  <p class="text-muted mb-0">{{ salon.address }}</p>
</div>

<form method="post" action="{% url 'marketplace:booking_start' salon.id service.id %}">
  {% csrf_token %}

  {% if form.non_field_errors %}
    <div class="alert alert-danger">
      {{ form.non_field_errors }}
    </div>
  {% endif %}

  <div class="mb-3">
    <label class="form-label small fw-bold">Select Master</label>
    {{ form.master }}
    {% if form.master.errors %}<div class="text-danger small">{{ form.master.errors }}</div>{% endif %}
  </div>

  <div class="mb-3">
    <label class="form-label small fw-bold">Date</label>
    {{ form.date }}
    {% if form.date.errors %}<div class="text-danger small">{{ form.date.errors }}</div>{% endif %}
  </div>

  <div class="mb-3">
    <label class="form-label small fw-bold">Time</label>

    <!-- Force an input that JS can fill -->
    <input
      type="text"
      name="time"
      id="id_time"
      class="form-control"
      placeholder="Select from available times below"
      readonly
      required
      value="{% if form.data.time %}{{ form.data.time }}{% endif %}"
    >
    {% if form.time.errors %}<div class="text-danger small">{{ form.time.errors }}</div>{% endif %}
  </div>

  <div class="slots-section mt-4">
    <label class="small fw-bold d-block mb-2">Available Times</label>
    <div id="slotsBox" class="d-flex flex-wrap gap-1"></div>
    <div id="slotsHint" class="text-muted small mt-1">Please select master and date.</div>
  </div>

  <div class="mt-4 border-top pt-3">
    <button type="submit" class="btn btn-dark w-100 py-2 fw-bold" style="background-color: var(--booksy-teal); border:none;">
      Confirm Appointment
    </button>
  </div>
</form>
